<%page args="type"/>

<div class="row">
<div class="span10 offset2">
<form class="form-inline">
<input type="text" id="${type}name" placeholder="New ${type}" class="input-medium"></input>
<button id="${type}create" class="btn btn-primary" type="submit">Create</button>
</form>
</div>
</div>

<div id="${type}-prompt-modal" class="modal hide fade" role="dialog"
     aria-labelledby="prompt-modal-label" aria-hidden="true">
  <div class="modal-header">
    <button class="close" type="button" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>Invalid Input</h3>
  </div>
  <div class="modal-body">
    The new ${type} name is invalid. It cannot be empty and
    may only contain the following characters: alphanumeric, '-', and
    '_'.
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
</div>

<script type="text/javascript">
    $("#${type}create").click(function (e) {
        e.preventDefault();
        var name = $("#${type}name").val();
        if (name.match(/^[\w-]+$/g) === null) {
            $("#${type}-prompt-modal").modal("show");
        } else {
            $.ajax({
                url: "/v1.1/${type}s/" + name,
                type: 'POST',
                dataType: 'json',
                data: JSON.stringify({}),
                processData: false,
                contentType: 'application/json',
                complete: function() {
                    window.location = "/admin/${type}s/" + name;
                },
            });
        }
    });
</script>
